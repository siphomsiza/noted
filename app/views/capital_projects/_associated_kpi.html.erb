<div class="row">

  <table class="table table-responsive table-striped">
    <tr>
      <th>Ref:</th>
      <td>D<%= @capital_project.departmental_sdbip.id %></td>
    </tr>
    <tr>
      <th>Department:</th>
      <td><%= @capital_project.subdepartment.department.name %></td>
    </tr>
    <tr>
      <th>KPI:</th>
      <td><%= @capital_project.departmental_sdbip.kpi %></td>
    </tr>
    <tr>
      <th>Unit of Measurement:</th>
      <td><%= @capital_project.departmental_sdbip.unit_of_measurement %></td>
    </tr>
    <tr>
      <th>Source of Evidence:</th>
      <td><%= @capital_project.departmental_sdbip.source_of_evidence %></td>
    </tr>
    <tr>
      <th>KPI calculation Type:</th>
      <td><%= @capital_project.departmental_sdbip.kpi_calculation_type.name %></td>
    </tr>
  </table>
  <table class="table table-responsive table-bordered table-striped">
    <tr>
      <th rowspan="2"></th>
      <th colspan="3">Period Performance</th>
      <th rowspan="2" colspan="1">Performance Comments</th>
      <th rowspan="2" colspan="1">Corrective Measures</th>
      <th rowspan="2" colspan="1">Proof of Evidence</th>
      <th rowspan="2" colspan="1">Update Status</th>
      <th rowspan="2" colspan="1">Assurance Status</th>
    </tr>
    <tr>
      <th>Target</th>
      <th>Actual</th>
      <th>Results</th>
    </tr>
    <tr>
      <th>July</th>
      <% @capital_project.departmental_sdbip.kpi_results.where("extract(month  from created_at) = ?", 7 ).each do |kpi_result| %>
      <td><%= kpi_result.target %></td>
      <td><%= kpi_result.actual %></td>
      <td><%= kpi_result.kpi_performance_standard %></td>
      <td><%= kpi_result.performance_comments %></td>
      <td><%= kpi_result.corrective_measures %></td>
      <td>
        <% kpi_result.attachments.each do |attachment| %>
          <%= link_to attachment.poe %>
        <% end %>
      </td>
      <td>
          <%= kpi_result.user.firstname %>&nbsp;
          <%= kpi_result.user.surname %>&nbsp;on
          <%= kpi_result.updated_at.strftime("%d-%b-%Y") %>
      </td>
      <td></td>
      <% end %>
    </tr>
    <tr>
      <th>August</th>
      <% @capital_project.departmental_sdbip.kpi_results.where("extract(month  from created_at) = ?", 8 ).each do |kpi_result| %>
      <td><%= kpi_result.target %></td>
      <td><%= kpi_result.actual %></td>
      <td><%= kpi_result.kpi_performance_standard %></td>
      <td><%= kpi_result.performance_comments %></td>
      <td><%= kpi_result.corrective_measures %></td>
      <td>
        <% kpi_result.attachments.each do |attachment| %>
          <%= link_to attachment.poe %>
        <% end %>
      </td>
      <td>
          <%= kpi_result.user.firstname %>&nbsp;
          <%= kpi_result.user.surname %>&nbsp;on
          <%= kpi_result.updated_at.strftime("%d-%b-%Y") %>
      </td>
      <td></td>
      <% end %>
    </tr>
    <tr>
      <th>Sepetember</th>
      <% @capital_project.departmental_sdbip.kpi_results.where("extract(month  from created_at) = ?", 9 ).each do |kpi_result| %>
      <td><%= kpi_result.target %></td>
      <td><%= kpi_result.actual %></td>
      <td><%= kpi_result.kpi_performance_standard %></td>
      <td><%= kpi_result.performance_comments %></td>
      <td><%= kpi_result.corrective_measures %></td>
      <td>
        <% kpi_result.attachments.each do |attachment| %>
          <%= link_to attachment.poe %>
        <% end %>
      </td>
      <td>
          <%= kpi_result.user.firstname %>&nbsp;
          <%= kpi_result.user.surname %>&nbsp;on
          <%= kpi_result.updated_at.strftime("%d-%b-%Y") %>
      </td>
      <td></td>
      <% end %>
    </tr>
    <tr>
      <th>October</th>
      <% @capital_project.departmental_sdbip.kpi_results.where("extract(month  from created_at) = ?", 10 ).each do |kpi_result| %>
      <td><%= kpi_result.target %></td>
      <td><%= kpi_result.actual %></td>
      <td><%= kpi_result.kpi_performance_standard %></td>
      <td><%= kpi_result.performance_comments %></td>
      <td><%= kpi_result.corrective_measures %></td>
      <td>
        <% kpi_result.attachments.each do |attachment| %>
          <%= link_to attachment.poe %>
        <% end %>
      </td>
      <td>
          <%= kpi_result.user.firstname %>&nbsp;
          <%= kpi_result.user.surname %>&nbsp;on
          <%= kpi_result.updated_at.strftime("%d-%b-%Y") %>
      </td>
      <td></td>
      <% end %>
    </tr>
    <tr>
      <th>November</th>
      <% @capital_project.departmental_sdbip.kpi_results.where("extract(month  from created_at) = ?", 11 ).each do |kpi_result| %>
      <td><%= kpi_result.target %></td>
      <td><%= kpi_result.actual %></td>
      <td><%= kpi_result.kpi_performance_standard %></td>
      <td><%= kpi_result.performance_comments %></td>
      <td><%= kpi_result.corrective_measures %></td>
      <td>
        <% kpi_result.attachments.each do |attachment| %>
          <%= link_to attachment.poe %>
        <% end %>
      </td>
      <td>
          <%= kpi_result.user.firstname %>&nbsp;
          <%= kpi_result.user.surname %>&nbsp;on
          <%= kpi_result.updated_at.strftime("%d-%b-%Y") %>
      </td>
      <td></td>
      <% end %>
    </tr>
    <tr>
      <th>December</th>
      <% @capital_project.departmental_sdbip.kpi_results.where("extract(month  from created_at) = ?", 12 ).each do |kpi_result| %>
      <td><%= kpi_result.target %></td>
      <td><%= kpi_result.actual %></td>
      <td><%= kpi_result.kpi_performance_standard %></td>
      <td><%= kpi_result.performance_comments %></td>
      <td><%= kpi_result.corrective_measures %></td>
      <td>
        <% kpi_result.attachments.each do |attachment| %>
          <%= link_to attachment.poe %>
        <% end %>
      </td>
      <td>
          <%= kpi_result.user.firstname %>&nbsp;
          <%= kpi_result.user.surname %>&nbsp;on
          <%= kpi_result.updated_at.strftime("%d-%b-%Y") %>
      </td>
      <td></td>
      <% end %>
    </tr>
    <tr>
      <th>January</th>
      <% @capital_project.departmental_sdbip.kpi_results.where("extract(month  from created_at) = ?", 1 ).each do |kpi_result| %>
      <td><%= kpi_result.target %></td>
      <td><%= kpi_result.actual %></td>
      <td><%= kpi_result.kpi_performance_standard %></td>
      <td><%= kpi_result.performance_comments %></td>
      <td><%= kpi_result.corrective_measures %></td>
      <td>
        <% kpi_result.attachments.each do |attachment| %>
          <%= link_to attachment.poe %>
        <% end %>
      </td>
      <td>
          <%= kpi_result.user.firstname %>&nbsp;
          <%= kpi_result.user.surname %>&nbsp;on
          <%= kpi_result.updated_at.strftime("%d-%b-%Y") %>
      </td>
      <td></td>
      <% end %>
    </tr>
    <tr>
      <th>February</th>
      <% @capital_project.departmental_sdbip.kpi_results.where("extract(month  from created_at) = ?", 2 ).each do |kpi_result| %>
      <td><%= kpi_result.target %></td>
      <td><%= kpi_result.actual %></td>
      <td><%= kpi_result.kpi_performance_standard %></td>
      <td><%= kpi_result.performance_comments %></td>
      <td><%= kpi_result.corrective_measures %></td>
      <td>
        <% kpi_result.attachments.each do |attachment| %>
          <%= link_to attachment.poe %>
        <% end %>
      </td>
      <td>
          <%= kpi_result.user.firstname %>&nbsp;
          <%= kpi_result.user.surname %>&nbsp;on
          <%= kpi_result.updated_at.strftime("%d-%b-%Y") %>
      </td>
      <td></td>
      <% end %>
    </tr>
    <tr>
      <th>March</th>
      <% @capital_project.departmental_sdbip.kpi_results.where("extract(month  from created_at) = ?", 3 ).each do |kpi_result| %>
      <td><%= kpi_result.target %></td>
      <td><%= kpi_result.actual %></td>
      <td><%= kpi_result.kpi_performance_standard %></td>
      <td><%= kpi_result.performance_comments %></td>
      <td><%= kpi_result.corrective_measures %></td>
      <td>
        <% kpi_result.attachments.each do |attachment| %>
          <%= link_to attachment.poe %>
        <% end %>
      </td>
      <td>
          <%= kpi_result.user.firstname %>&nbsp;
          <%= kpi_result.user.surname %>&nbsp;on
          <%= kpi_result.updated_at.strftime("%d-%b-%Y") %>
      </td>
      <td></td>
      <% end %>
    </tr>
    <tr>
      <th>April</th>
      <% @capital_project.departmental_sdbip.kpi_results.where("extract(month  from created_at) = ?", 4 ).each do |kpi_result| %>
      <td><%= kpi_result.target %></td>
      <td><%= kpi_result.actual %></td>
      <td><%= kpi_result.kpi_performance_standard %></td>
      <td><%= kpi_result.performance_comments %></td>
      <td><%= kpi_result.corrective_measures %></td>
      <td>
        <% kpi_result.attachments.each do |attachment| %>
          <%= link_to attachment.poe %>
        <% end %>
      </td>
      <td>
          <%= kpi_result.user.firstname %>&nbsp;
          <%= kpi_result.user.surname %>&nbsp;on
          <%= kpi_result.updated_at.strftime("%d-%b-%Y") %>
      </td>
      <td></td>
      <% end %>
    </tr>
    <tr>
      <th>May</th>
      <% @capital_project.departmental_sdbip.kpi_results.where("extract(month  from created_at) = ?", 5 ).each do |kpi_result| %>
      <td><%= kpi_result.target %></td>
      <td><%= kpi_result.actual %></td>
      <td><%= kpi_result.kpi_performance_standard %></td>
      <td><%= kpi_result.performance_comments %></td>
      <td><%= kpi_result.corrective_measures %></td>
      <td>
        <% kpi_result.attachments.each do |attachment| %>
          <%= link_to attachment.poe %>
        <% end %>
      </td>
      <td>
          <%= kpi_result.user.firstname %>&nbsp;
          <%= kpi_result.user.surname %>&nbsp;on
          <%= kpi_result.updated_at.strftime("%d-%b-%Y") %>
      </td>
      <td></td>
      <% end %>
    </tr>
    <tr>
      <th>June</th>
      <% @capital_project.departmental_sdbip.kpi_results.where("extract(month  from created_at) = ?", 6 ).each do |kpi_result| %>
      <td><%= kpi_result.target %></td>
      <td><%= kpi_result.actual %></td>
      <td><%= kpi_result.kpi_performance_standard %></td>
      <td><%= kpi_result.performance_comments %></td>
      <td><%= kpi_result.corrective_measures %></td>
      <td>
        <% kpi_result.attachments.each do |attachment| %>
          <%= link_to attachment.poe %>
        <% end %>
      </td>
      <td>
          <%= kpi_result.user.firstname %>&nbsp;
          <%= kpi_result.user.surname %>&nbsp;on
          <%= kpi_result.updated_at.strftime("%d-%b-%Y") %>
      </td>
      <td></td>
      <% end %>
    </tr>
  </table>
</div>
